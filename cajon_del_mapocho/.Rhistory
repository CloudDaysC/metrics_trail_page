formatPercentage(c("% Distancia acumulada", `% Desnivel Acumulado`, `% Distancia Eq acumulada`), 2)
#https://www.strava.com/routes/2762818189864795836
datatable(tabla_dist, rownames = FALSE, filter="none",
options = list(pageLength = 11, scrollX=F, searching=F, ordering=F, lengthChange = F) ) %>%
formatPercentage(c("% Distancia acumulada", "% Desnivel Acumulado", "% Distancia Eq acumulada"), 2)
#https://www.strava.com/routes/2762818189864795836
datatable(tabla_dist, rownames = FALSE, filter="none",
options = list(pageLength = 11, scrollX=F, searching=F, ordering=F, lengthChange = F) ) %>%
formatPercentage(c("% Distancia acumulada", "% Desnivel Acumulado", "% Distancia Eq acumulada"), 1)
#https://www.strava.com/routes/2762818189864795836
datatable(tabla_dist, rownames = FALSE, filter="none",
options = list(pageLength = 11, scrollX=F, searching=F, ordering=F, lengthChange = F) ) %>%
formatPercentage(c("% Distancia acumulada", "% Desnivel Acumulado", "% Distancia Eq acumulada"), 0)
knitr::opts_chunk$set(echo = TRUE)
library(GPStream)
library(sp)
library(leaflet)
library(tidyverse)
library(RColorBrewer)
ruta_strm <-
read_stream_file("cajon_del_mapocho.gpx") %>%
rename_stream() %>%
differential_stream()
ruta_sp <- SpatialPointsDataFrame(data=ruta_strm,
coords = ruta_strm[,c("lon","lat")],
proj4string=CRS("+proj=longlat +datum=WGS84"))
PCS <- c(9.65, 22.05, 33.35, 42.05, 45.7, 50.82, 63.5, 81.55, 87.7)
colores <- brewer.pal(n = 9, name = "Paired")
tramo1 <- ruta_strm %>% filter(distance <= PCS[1])
tramo2 <- ruta_strm %>% filter(distance > PCS[1] & distance <= PCS[2])
tramo3 <- ruta_strm %>% filter(distance > PCS[2] & distance <= PCS[3])
tramo4 <- ruta_strm %>% filter(distance > PCS[3] & distance <= PCS[4])
tramo5 <- ruta_strm %>% filter(distance > PCS[4] & distance <= PCS[5])
tramo6 <- ruta_strm %>% filter(distance > PCS[5] & distance <= PCS[6])
tramo7 <- ruta_strm %>% filter(distance > PCS[6] & distance <= PCS[7])
tramo8 <- ruta_strm %>% filter(distance > PCS[7] & distance <= PCS[8])
tramo9 <- ruta_strm %>% filter(distance > PCS[8] & distance <= PCS[9])
tabla <- data.frame( "Tramo" = c("Tramo 1","Tramo 2","Tramo 3","Tramo 4","Tramo 5","Tramo 6","Tramo 7","Tramo 8","Tramo 9","Total"),
"Distancia" = c(sum(tramo1$delta_distance),
sum(tramo2$delta_distance),
sum(tramo3$delta_distance),
sum(tramo4$delta_distance),
sum(tramo5$delta_distance),
sum(tramo6$delta_distance),
sum(tramo7$delta_distance),
sum(tramo8$delta_distance),
sum(tramo9$delta_distance),
sum(ruta_strm$delta_distance)),
"ElevGain" =  c(sum(tramo1$dplus),
sum(tramo2$dplus),
sum(tramo3$dplus),
sum(tramo4$dplus),
sum(tramo5$dplus),
sum(tramo6$dplus),
sum(tramo7$dplus),
sum(tramo8$dplus),
sum(tramo9$dplus),
sum(ruta_strm$dplus)))
hitos <- data.frame(rbind(c(tramo1[1,c("lon","lat","ele")], "Puente Ã‘ilhue"),
c(tramo2[1,c("lon","lat","ele")], "Llanos de Javier"),
c(tramo3[1,c("lon","lat","ele")], "Corral quemado"),
c(tramo4[1,c("lon","lat","ele")], "La Parva"),
c(tramo5[1,c("lon","lat","ele")], "Cancha de carreras"),
c(tramo6[1,c("lon","lat","ele")], "Federacion"),
c(tramo7[1,c("lon","lat","ele")], "Piedra numerada"),
c(tramo8[1,c("lon","lat","ele")], "Refugio del Cepo"),
c(tramo9[1,c("lon","lat","ele")], "La Ermita")))
hitos$lat <- as.numeric(hitos$lat)
hitos$lon <- as.numeric(hitos$lon)
hitossp <- SpatialPointsDataFrame(data=hitos, coords = hitos[,1:2], proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo1sp <- tramo1 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo2sp <- tramo2 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo3sp <- tramo3 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo4sp <- tramo4 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo5sp <- tramo5 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo6sp <- tramo6 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo7sp <- tramo7 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo8sp <- tramo8 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo9sp <- tramo9 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
datatable(tabla_dist, rownames = FALSE, filter="none",
options = list(pageLength = 11, scrollX=F, searching=F, ordering=F, lengthChange = F, paging=F, info=F) ) %>%
formatPercentage(c("% Distancia acumulada", "% Desnivel Acumulado", "% Distancia Eq acumulada"), 0)
library(DT)
library(googlesheets4)
tabla_dist <- read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
tabla_dist <- read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
tabla_dist$`Tiempo 2020` <- substr(as.character(tabla_dist$`Tiempo 2020`),12,22)
tabla_dist$Tramo <- c(1:9,NA)
datatable(tabla_dist, rownames = FALSE, filter="none",
options = list(pageLength = 11, scrollX=F, searching=F, ordering=F, lengthChange = F, paging=F, info=F) ) %>%
formatPercentage(c("% Distancia acumulada", "% Desnivel Acumulado", "% Distancia Eq acumulada"), 0)
library(tmap)
install.packages("tmap")
data(World)  # The dataset is stored as an sf object
library(tmap)
data(World)  # The dataset is stored as an sf object
# Let's check its current coordinate system
st_crs(World)
library(raster)
# Let's check its current coordinate system
st_crs(World)
library(sf)
# Let's check its current coordinate system
st_crs(World)
st_crs(World.ae)
World.ae <- st_transform(World, "+proj=aeqd +lat_0=0 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.ae) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=44.5 +lon_0=-69.8 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=-100.1373 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=-90.1373 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=-80.1373 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=-70.1373 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
tm_shape(World.ae) + tm_fill()
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=-70.1373 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=-100.1373 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=-150.1373 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=-100.1373 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=-70 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=70 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=-70 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-34.2308 +lon_0=-30 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
World.aemaine <- st_transform(World, "+proj=aeqd +lat_0=-74.2308 +lon_0=-70 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")
tm_shape(World.aemaine) + tm_fill()
library(magrittr)
app_name <- 'strafy' # chosen by user
app_client_id  <- '22617' # an integer, assigned by Strava
app_secret <- 'ccf42319abaea7264273ef4ccb6e330f7126223b' # an alphanumeric secret, assigned by Strava
stoken <-  tryCatch(httr::config(token = readRDS('.httr-oauth')[[1]]),
error = httr::config(token =
rStrava::strava_oauth(app_name,
app_client_id,
app_secret,
app_scope = "activity:read_all",
cache = TRUE)))
# retrieve metadata, exclude activities without GPS recording
act_metadata <<- rStrava::get_activity_list(stoken) %>%
rStrava::compile_activities() %>%
suppressWarnings(rStrava::chk_nopolyline())
stoken <-  tryCatch(httr::config(token = readRDS('.httr-oauth')[[1]]),
error = httr::config(token =
rStrava::strava_oauth(app_name,
app_client_id,
app_secret,
app_scope = "activity:read_all",
cache = TRUE)))
httr::config(token =
rStrava::strava_oauth(app_name,
app_client_id,
app_secret,
app_scope = "activity:read_all",
cache = TRUE))
stoken <-  tryCatch(httr::config(token = readRDS('.httr-oauth')[[1]]),
error = httr::config(token =
rStrava::strava_oauth(app_name,
app_client_id,
app_secret,
app_scope = "activity:read_all",
cache = TRUE)))
# retrieve metadata, exclude activities without GPS recording
act_metadata <<- rStrava::get_activity_list(stoken) %>%
rStrava::compile_activities() %>%
suppressWarnings(rStrava::chk_nopolyline())
act_metadata3 <<- act_metadata[1001:1139,]
act_metadata2 <<- act_metadata[501:1000,]
act_metadata <<- act_metadata[1:500,]
# get selected activities streams and rename variables
streams <<- rStrava::get_activity_streams(act_metadata, stoken)
act_metadata %>% filter(manual == "FALSE")
act_metadata$manual
act_metadata %>% filter(manual == "FALSE")
# retrieve metadata, exclude activities without GPS recording
act_metadata <<- rStrava::get_activity_list(stoken) %>%
rStrava::compile_activities() %>%
suppressWarnings(rStrava::chk_nopolyline()) %>%
filter(manual == "FALSE")
# retrieve metadata, exclude activities without GPS recording
act_metadata <<- rStrava::get_activity_list(stoken) %>%
rStrava::compile_activities() %>%
suppressWarnings(rStrava::chk_nopolyline())
library(tidyverse)
act_metadata <- act_metadata %>% filter(manual == "FALSE")
act_metadata1 <<- act_metadata[1:500,]
act_metadata2 <<- act_metadata[501:1000,]
act_metadata3 <<- act_metadata[1001:1122,]
# get selected activities streams and rename variables
streams <<- rStrava::get_activity_streams(act_metadata1, stoken)
# get selected activities streams and rename variables
streams <<- rStrava::get_activity_streams(act_metadata1, stoken)
act_metadata1 <<- act_metadata[1:500,]
act_metadata <- act_metadata %>% filter(manual == "FALSE")
act_metadata1 <<- act_metadata[1:500,]
act_metadata2 <<- act_metadata[501:1000,]
act_metadata3 <<- act_metadata[1001:1122,]
# get selected activities streams and rename variables
streams <<- rStrava::get_activity_streams(act_metadata1, stoken)
# retrieve metadata, exclude activities without GPS recording
act_metadata <<- rStrava::get_activity_list(stoken) %>%
rStrava::compile_activities() %>%
suppressWarnings(rStrava::chk_nopolyline()) %>%
filter(manual == "FALSE")
act_metadata1 <- act_metadata[1:500,]
act_metadata2 <- act_metadata[501:1000,]
act_metadata3 <- act_metadata[1001:1122,]
# get selected activities streams and rename variables
streams <<- rStrava::get_activity_streams(act_metadata1, stoken)
stoken <-  tryCatch(httr::config(token = readRDS('.httr-oauth')[[1]]),
error = httr::config(token =
rStrava::strava_oauth(app_name,
app_client_id,
app_secret,
app_scope = "activity:read_all",
cache = TRUE)))
# get selected activities streams and rename variables
streams <- rStrava::get_activity_streams(act_metadata1, stoken)
View(act_metadata1)
View(act_metadata)
# retrieve metadata, exclude activities without GPS recording
act_metadata <<- rStrava::get_activity_list(stoken) %>%
rStrava::compile_activities() %>%
suppressWarnings(rStrava::chk_nopolyline()) %>%
filter(manual == "FALSE", !is.na(map.summary_polyline))
act_metadata1 <- act_metadata[1:500,]
act_metadata2 <- act_metadata[501:1000,]
act_metadata3 <- act_metadata[1001:1058,]
# get selected activities streams and rename variables
streams <- rStrava::get_activity_streams(act_metadata1, stoken)
streams2 <- rStrava::get_activity_streams(act_metadata2, stoken)
streams3 <- rStrava::get_activity_streams(act_metadata3, stoken)
str <- rbind(streams, streams2, streams3)
str <- rbind.fill(streams, streams2, streams3)
str <- data.table::rbind.fill(streams, streams2, streams3)
str <- dplyr::rbind.fill(streams, streams2, streams3)
str <- plyr::rbind.fill(streams, streams2, streams3)
aa <- list(str, act_metadata)
aa <- list("streams" = str,"act_data" = act_metadata)
write_rds(aa, "streams_rai1058.rds")
write_rds(aa, "streams_rai1058.rdata")
knitr::opts_chunk$set(echo = TRUE)
library(GPStream)
library(sp)
library(leaflet)
library(tidyverse)
library(RColorBrewer)
ruta_strm <-
read_stream_file("cajon_del_mapocho.gpx") %>%
rename_stream() %>%
differential_stream()
ruta_sp <- SpatialPointsDataFrame(data=ruta_strm,
coords = ruta_strm[,c("lon","lat")],
proj4string=CRS("+proj=longlat +datum=WGS84"))
PCS <- c(9.65, 22.05, 33.35, 42.05, 45.7, 50.82, 63.5, 81.55, 87.7)
colores <- brewer.pal(n = 9, name = "Paired")
tramo1 <- ruta_strm %>% filter(distance <= PCS[1])
tramo2 <- ruta_strm %>% filter(distance > PCS[1] & distance <= PCS[2])
tramo3 <- ruta_strm %>% filter(distance > PCS[2] & distance <= PCS[3])
tramo4 <- ruta_strm %>% filter(distance > PCS[3] & distance <= PCS[4])
tramo5 <- ruta_strm %>% filter(distance > PCS[4] & distance <= PCS[5])
tramo6 <- ruta_strm %>% filter(distance > PCS[5] & distance <= PCS[6])
tramo7 <- ruta_strm %>% filter(distance > PCS[6] & distance <= PCS[7])
tramo8 <- ruta_strm %>% filter(distance > PCS[7] & distance <= PCS[8])
tramo9 <- ruta_strm %>% filter(distance > PCS[8] & distance <= PCS[9])
tabla <- data.frame( "Tramo" = c("Tramo 1","Tramo 2","Tramo 3","Tramo 4","Tramo 5","Tramo 6","Tramo 7","Tramo 8","Tramo 9","Total"),
"Distancia" = c(sum(tramo1$delta_distance),
sum(tramo2$delta_distance),
sum(tramo3$delta_distance),
sum(tramo4$delta_distance),
sum(tramo5$delta_distance),
sum(tramo6$delta_distance),
sum(tramo7$delta_distance),
sum(tramo8$delta_distance),
sum(tramo9$delta_distance),
sum(ruta_strm$delta_distance)),
"ElevGain" =  c(sum(tramo1$dplus),
sum(tramo2$dplus),
sum(tramo3$dplus),
sum(tramo4$dplus),
sum(tramo5$dplus),
sum(tramo6$dplus),
sum(tramo7$dplus),
sum(tramo8$dplus),
sum(tramo9$dplus),
sum(ruta_strm$dplus)))
hitos <- data.frame(rbind(c(tramo1[1,c("lon","lat","ele")], "Puente Ã‘ilhue"),
c(tramo2[1,c("lon","lat","ele")], "Llanos de Javier"),
c(tramo3[1,c("lon","lat","ele")], "Corral quemado"),
c(tramo4[1,c("lon","lat","ele")], "La Parva"),
c(tramo5[1,c("lon","lat","ele")], "Cancha de carreras"),
c(tramo6[1,c("lon","lat","ele")], "Federacion"),
c(tramo7[1,c("lon","lat","ele")], "Piedra numerada"),
c(tramo8[1,c("lon","lat","ele")], "Refugio del Cepo"),
c(tramo9[1,c("lon","lat","ele")], "La Ermita")))
hitos$lat <- as.numeric(hitos$lat)
hitos$lon <- as.numeric(hitos$lon)
hitossp <- SpatialPointsDataFrame(data=hitos, coords = hitos[,1:2], proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo1sp <- tramo1 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo2sp <- tramo2 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo3sp <- tramo3 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo4sp <- tramo4 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo5sp <- tramo5 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo6sp <- tramo6 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo7sp <- tramo7 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo8sp <- tramo8 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo9sp <- tramo9 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tabla_dist <- read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
library(googlesheets4)
tabla_dist <- read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
library(googlesheets)
library(DT)
library(googlesheets4)
library(googlesheets)
tabla_dist <- read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
? read_sheet
tabla_dist <- googlesheets::read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
tabla_dist <- googlesheets4::read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
tabla_dist <- read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
knitr::opts_chunk$set(echo = TRUE)
library(GPStream)
library(sp)
library(leaflet)
library(tidyverse)
library(RColorBrewer)
ruta_strm <-
read_stream_file("cajon_del_mapocho.gpx") %>%
rename_stream() %>%
differential_stream()
ruta_sp <- SpatialPointsDataFrame(data=ruta_strm,
coords = ruta_strm[,c("lon","lat")],
proj4string=CRS("+proj=longlat +datum=WGS84"))
PCS <- c(9.65, 22.05, 33.35, 42.05, 45.7, 50.82, 63.5, 81.55, 87.7)
colores <- brewer.pal(n = 9, name = "Paired")
tramo1 <- ruta_strm %>% filter(distance <= PCS[1])
tramo2 <- ruta_strm %>% filter(distance > PCS[1] & distance <= PCS[2])
tramo3 <- ruta_strm %>% filter(distance > PCS[2] & distance <= PCS[3])
tramo4 <- ruta_strm %>% filter(distance > PCS[3] & distance <= PCS[4])
tramo5 <- ruta_strm %>% filter(distance > PCS[4] & distance <= PCS[5])
tramo6 <- ruta_strm %>% filter(distance > PCS[5] & distance <= PCS[6])
tramo7 <- ruta_strm %>% filter(distance > PCS[6] & distance <= PCS[7])
tramo8 <- ruta_strm %>% filter(distance > PCS[7] & distance <= PCS[8])
tramo9 <- ruta_strm %>% filter(distance > PCS[8] & distance <= PCS[9])
tabla <- data.frame( "Tramo" = c("Tramo 1","Tramo 2","Tramo 3","Tramo 4","Tramo 5","Tramo 6","Tramo 7","Tramo 8","Tramo 9","Total"),
"Distancia" = c(sum(tramo1$delta_distance),
sum(tramo2$delta_distance),
sum(tramo3$delta_distance),
sum(tramo4$delta_distance),
sum(tramo5$delta_distance),
sum(tramo6$delta_distance),
sum(tramo7$delta_distance),
sum(tramo8$delta_distance),
sum(tramo9$delta_distance),
sum(ruta_strm$delta_distance)),
"ElevGain" =  c(sum(tramo1$dplus),
sum(tramo2$dplus),
sum(tramo3$dplus),
sum(tramo4$dplus),
sum(tramo5$dplus),
sum(tramo6$dplus),
sum(tramo7$dplus),
sum(tramo8$dplus),
sum(tramo9$dplus),
sum(ruta_strm$dplus)))
hitos <- data.frame(rbind(c(tramo1[1,c("lon","lat","ele")], "Puente Ã‘ilhue"),
c(tramo2[1,c("lon","lat","ele")], "Llanos de Javier"),
c(tramo3[1,c("lon","lat","ele")], "Corral quemado"),
c(tramo4[1,c("lon","lat","ele")], "La Parva"),
c(tramo5[1,c("lon","lat","ele")], "Cancha de carreras"),
c(tramo6[1,c("lon","lat","ele")], "Federacion"),
c(tramo7[1,c("lon","lat","ele")], "Piedra numerada"),
c(tramo8[1,c("lon","lat","ele")], "Refugio del Cepo"),
c(tramo9[1,c("lon","lat","ele")], "La Ermita")))
hitos$lat <- as.numeric(hitos$lat)
hitos$lon <- as.numeric(hitos$lon)
hitossp <- SpatialPointsDataFrame(data=hitos, coords = hitos[,1:2], proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo1sp <- tramo1 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo2sp <- tramo2 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo3sp <- tramo3 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo4sp <- tramo4 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo5sp <- tramo5 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo6sp <- tramo6 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo7sp <- tramo7 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo8sp <- tramo8 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo9sp <- tramo9 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
library(googlesheets4)
tabla_dist <- read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
tabla_dist <- read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
library(googlesheets4)
tabla_dist <- read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
knitr::opts_chunk$set(echo = TRUE)
library(GPStream)
library(sp)
library(leaflet)
library(tidyverse)
library(RColorBrewer)
ruta_strm <-
read_stream_file("cajon_del_mapocho.gpx") %>%
rename_stream() %>%
differential_stream()
ruta_sp <- SpatialPointsDataFrame(data=ruta_strm,
coords = ruta_strm[,c("lon","lat")],
proj4string=CRS("+proj=longlat +datum=WGS84"))
PCS <- c(9.65, 22.05, 33.35, 42.05, 45.7, 50.82, 63.5, 81.55, 87.7)
colores <- brewer.pal(n = 9, name = "Paired")
tramo1 <- ruta_strm %>% filter(distance <= PCS[1])
tramo2 <- ruta_strm %>% filter(distance > PCS[1] & distance <= PCS[2])
tramo3 <- ruta_strm %>% filter(distance > PCS[2] & distance <= PCS[3])
tramo4 <- ruta_strm %>% filter(distance > PCS[3] & distance <= PCS[4])
tramo5 <- ruta_strm %>% filter(distance > PCS[4] & distance <= PCS[5])
tramo6 <- ruta_strm %>% filter(distance > PCS[5] & distance <= PCS[6])
tramo7 <- ruta_strm %>% filter(distance > PCS[6] & distance <= PCS[7])
tramo8 <- ruta_strm %>% filter(distance > PCS[7] & distance <= PCS[8])
tramo9 <- ruta_strm %>% filter(distance > PCS[8] & distance <= PCS[9])
tabla <- data.frame( "Tramo" = c("Tramo 1","Tramo 2","Tramo 3","Tramo 4","Tramo 5","Tramo 6","Tramo 7","Tramo 8","Tramo 9","Total"),
"Distancia" = c(sum(tramo1$delta_distance),
sum(tramo2$delta_distance),
sum(tramo3$delta_distance),
sum(tramo4$delta_distance),
sum(tramo5$delta_distance),
sum(tramo6$delta_distance),
sum(tramo7$delta_distance),
sum(tramo8$delta_distance),
sum(tramo9$delta_distance),
sum(ruta_strm$delta_distance)),
"ElevGain" =  c(sum(tramo1$dplus),
sum(tramo2$dplus),
sum(tramo3$dplus),
sum(tramo4$dplus),
sum(tramo5$dplus),
sum(tramo6$dplus),
sum(tramo7$dplus),
sum(tramo8$dplus),
sum(tramo9$dplus),
sum(ruta_strm$dplus)))
hitos <- data.frame(rbind(c(tramo1[1,c("lon","lat","ele")], "Puente Ã‘ilhue"),
c(tramo2[1,c("lon","lat","ele")], "Llanos de Javier"),
c(tramo3[1,c("lon","lat","ele")], "Corral quemado"),
c(tramo4[1,c("lon","lat","ele")], "La Parva"),
c(tramo5[1,c("lon","lat","ele")], "Cancha de carreras"),
c(tramo6[1,c("lon","lat","ele")], "Federacion"),
c(tramo7[1,c("lon","lat","ele")], "Piedra numerada"),
c(tramo8[1,c("lon","lat","ele")], "Refugio del Cepo"),
c(tramo9[1,c("lon","lat","ele")], "La Ermita")))
hitos$lat <- as.numeric(hitos$lat)
hitos$lon <- as.numeric(hitos$lon)
hitossp <- SpatialPointsDataFrame(data=hitos, coords = hitos[,1:2], proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo1sp <- tramo1 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo2sp <- tramo2 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo3sp <- tramo3 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo4sp <- tramo4 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo5sp <- tramo5 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo6sp <- tramo6 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo7sp <- tramo7 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo8sp <- tramo8 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
tramo9sp <- tramo9 %>% select(lon,lat) %>%
SpatialPointsDataFrame( data = ., coords = .,proj4string=CRS("+proj=longlat +datum=WGS84"))
options(gargle_oauth_cache = ".secrets")
drive_auth(cache = ".secrets", email = "raimundosanchezu@gmail.com")
library(googledrive)
drive_auth(cache = ".secrets", email = "raimundosanchezu@gmail.com")
tabla_dist <- read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
gs4_auth(token = drive_token())
tabla_dist <- read_sheet("https://docs.google.com/spreadsheets/d/1gXVkYR1aznKo8HUoBd68Rq8AHgwLSCYWH52IdPTPYsg/edit?usp=sharing")
View(tramo8)
